import{H as I,I as w,J as S,K as B,y as T,L as y,w as A,D as N,M as Y,N as x,O as F,x as U,P as C,Q as $,R as q,S as G,G as H,U as p,V as Z,W as z,f as m,X as J,Y as D,Z as K,_ as Q,$ as V,g as P,k as W,a0 as X,a1 as j,s as ee,a2 as te,B as se,a3 as ae,a4 as re,o as ie,a5 as fe,a6 as ne,a7 as ce,a8 as de}from"./DIyslo3f.js";class ue{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#r=!0;constructor(e,s=!0){this.anchor=e,this.#r=s}#i=()=>{var e=I;if(this.#t.has(e)){var s=this.#t.get(e),r=this.#s.get(s);if(r)w(r),this.#a.delete(s);else{var i=this.#e.get(s);i&&(this.#s.set(s,i.effect),this.#e.delete(s),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),r=i.effect)}for(const[t,n]of this.#t){if(this.#t.delete(t),t===e)break;const f=this.#e.get(n);f&&(S(f.effect),this.#e.delete(n))}for(const[t,n]of this.#s){if(t===s||this.#a.has(t))continue;const f=()=>{if(Array.from(this.#t.values()).includes(t)){var u=document.createDocumentFragment();Y(n,u),u.append(T()),this.#e.set(t,{effect:n,fragment:u})}else S(n);this.#a.delete(t),this.#s.delete(t)};this.#r||!r?(this.#a.add(t),B(n,f,!1)):f()}}};#f=e=>{this.#t.delete(e);const s=Array.from(this.#t.values());for(const[r,i]of this.#e)s.includes(r)||(S(i.effect),this.#e.delete(r))};ensure(e,s){var r=I,i=x();if(s&&!this.#s.has(e)&&!this.#e.has(e))if(i){var t=document.createDocumentFragment(),n=T();t.append(n),this.#e.set(e,{effect:y(()=>s(n)),fragment:t})}else this.#s.set(e,y(()=>s(this.anchor)));if(this.#t.set(r,e),i){for(const[f,c]of this.#s)f===e?r.skipped_effects.delete(c):r.skipped_effects.add(c);for(const[f,c]of this.#e)f===e?r.skipped_effects.delete(c.effect):r.skipped_effects.add(c.effect);r.oncommit(this.#i),r.ondiscard(this.#f)}else A&&(this.anchor=N),this.#i()}}function le(a,e,s=!1){A&&U();var r=new ue(a),i=s?C:0;function t(n,f){if(A){const u=$(a)===q;if(n===u){var c=G();H(c),r.anchor=c,p(!1),r.ensure(n,f),p(!0);return}}r.ensure(n,f)}F(()=>{var n=!1;e((f,c=!0)=>{n=!0,t(c,f)}),n||t(!1,null)},i)}function O(a,e){return a===e||a?.[D]===e}function oe(a={},e,s,r){return Z(()=>{var i,t;return z(()=>{i=t,t=[],m(()=>{a!==s(...t)&&(e(a,...t),i&&O(s(...i),a)&&e(null,...i))})}),()=>{J(()=>{t&&O(s(...t),a)&&e(null,...t)})}}),a}let b=!1;function he(a){var e=b;try{return b=!1,[a(),b]}finally{b=e}}function ve(a,e,s,r){var i=!ie||(s&fe)!==0,t=(s&re)!==0,n=(s&ce)!==0,f=r,c=!0,u=()=>(c&&(c=!1,f=n?m(r):r),f),_;if(t){var k=D in a||de in a;_=K(a,e)?.set??(k&&e in a?d=>a[e]=d:void 0)}var l,E=!1;t?[l,E]=he(()=>a[e]):l=a[e],l===void 0&&r!==void 0&&(l=u(),_&&(i&&Q(),_(l)));var h;if(i?h=()=>{var d=a[e];return d===void 0?u():(c=!0,d)}:h=()=>{var d=a[e];return d!==void 0&&(f=void 0),d===void 0?f:d},i&&(s&V)===0)return h;if(_){var L=a.$$legacy;return(function(d,v){return arguments.length>0?((!i||!v||L||E)&&_(v?h():d),d):h()})}var g=!1,o=((s&ne)!==0?W:X)(()=>(g=!1,h()));t&&P(o);var M=se;return(function(d,v){if(arguments.length>0){const R=v?P(o):i&&t?j(d):d;return ee(o,R),g=!0,f!==void 0&&(f=R),d}return te&&g||(M.f&ae)!==0?o.v:P(o)})}export{ue as B,oe as b,le as i,ve as p};
